<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>請假申請表</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
    <h2>請假申請表</h2>
    <form id="leaveForm">
        <label>姓名：</label>
        <input type="text" id="name" required><br>

        <label>日期：</label>
        <input type="date" id="date" required><br>

        <label>年級：</label>
        <select id="grade">
            <option value="一年級">一年級</option>
            <option value="二年級">二年級</option>
            <option value="三年級">三年級</option>
        </select><br>

        <label>請假事由：</label>
        <textarea id="reason" required></textarea><br>

        <button type="button" onclick="submitLeave()">提交</button>
    </form>

    <script>
        const LINE_ACCESS_TOKEN = "VPI15bRAuAzGunrudPQsZ4gT0tL2BOIkO/qju+t3/4gkDcw+nx1JBS5BNMkhgfG/PIHvVNY8xZMzA/REz4ycMYl6DreoDD5uLh0OcSUwepfJ88Wl5nIUCtKzFJPnNplixXOp4LjVpSqwHip9vk/CWAdB04t89/1O/w1cDnyilFU=";
        const ADMIN_USER_ID = "Ub6bb0555e1a66d109de7d7ccdc7c8091";  // 你的管理員 User ID
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby9YLMglfFxZQ0_TjfWGj7BDRti8TXJnXUebrty6t7VLBk8qlDmkbEGb1X3Pwxnxjftog/exec'; // 填入你部署後的 Google Script URL

        async function submitLeave() {
            // 獲取表單資料
            const name = document.getElementById("name").value;
            const date = document.getElementById("date").value;
            const grade = document.getElementById("grade").value;
            const reason = document.getElementById("reason").value;

            // 準備要傳送的資料
            const formData = {
                name: name,
                date: date,
                grade: grade,
                reason: reason
            };

            try {
                // 發送資料到 Google Apps Script
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.text();
                alert(result);  // 顯示結果
            } catch (error) {
                alert("請假申請失敗，請稍後再試！");
                console.error(error);
            }
        }
    </script>
</body>
</html>
